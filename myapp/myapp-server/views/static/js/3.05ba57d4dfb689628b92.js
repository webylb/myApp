webpackJsonp([3],{"592T":function(s,t,e){"use strict";var i={name:"purchase-address",props:{addressInfo:{type:Object,default:null}},methods:{toSetAddress:function(){this.$emit("toSetAddress")}}},r={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"purchase-address",on:{click:s.toSetAddress}},[e("div",{staticClass:"purchase-inner"},[s.addressInfo?s._e():e("div",{staticClass:"no-default"},[e("i",{staticClass:"iconfont"},[s._v("")]),s._v("\n      请选择收货地址\n      "),e("i",{staticClass:"iconfont to-address"},[s._v("")])]),s._v(" "),s.addressInfo?e("div",{staticClass:"default"},[e("div",{staticClass:"top"},[e("i",{staticClass:"iconfont"},[s._v("")]),s._v(" "),e("span",[s._v(s._s(s.addressInfo.realname))]),s._v("  \n        "),e("span",[s._v(s._s(s.addressInfo.mobile))])]),s._v(" "),e("div",{staticClass:"bottom"},[s._v("\n        "+s._s(s.addressInfo.province+s.addressInfo.city+s.addressInfo.district+s.addressInfo.town+s.addressInfo.address)+"\n      ")])]):s._e()])])},staticRenderFns:[]};var n=e("VU/8")(i,r,!1,function(s){e("jWho")},"data-v-576a1beb",null);t.a=n.exports},"7Ht7":function(s,t){},"8rWN":function(s,t){},"9Pyr":function(s,t){},CPmH:function(s,t){},KlOE:function(s,t,e){"use strict";var i={render:function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"load-server"},[t("svg",{attrs:{"xmlns:svg":"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.0",width:"2.188rem",height:"2.188rem",viewBox:"0 0 128 128","xml:space":"preserve"}},[t("g",{attrs:{transform:"rotate(330 64 64)"}},[t("path",{attrs:{d:"M64 0a7 7 0 1 1-7 7 7 7 0 0 1 7-7zm29.86 12.2a2.8 2.8 0 1 1-3.83 1.02 2.8 2.8 0 0 1 3.83-1.02zm22.16 21.68a3.15 3.15 0 1 1-4.3-1.15 3.15 3.15 0 0 1 4.3 1.15zm.87 60.53a4.2 4.2 0 1 1-1.57-5.7 4.2 4.2 0 0 1 1.54 5.73zm7.8-30.5a3.85 3.85 0 1 1-3.85-3.85 3.85 3.85 0 0 1 3.85 3.84zm-30 53.2a4.55 4.55 0 1 1 1.66-6.23 4.55 4.55 0 0 1-1.67 6.22zM64 125.9a4.9 4.9 0 1 1 4.9-4.9 4.9 4.9 0 0 1-4.9 4.9zm-31.06-8.22a5.25 5.25 0 1 1 7.17-1.93 5.25 5.25 0 0 1-7.14 1.93zM9.9 95.1a5.6 5.6 0 1 1 7.65 2.06A5.6 5.6 0 0 1 9.9 95.1zM1.18 63.9a5.95 5.95 0 1 1 5.95 5.94 5.95 5.95 0 0 1-5.96-5.94zm8.1-31.6a6.3 6.3 0 1 1 2.32 8.6 6.3 6.3 0 0 1-2.3-8.6zM32.25 8.87a6.65 6.65 0 1 1-2.44 9.1 6.65 6.65 0 0 1 2.46-9.1z",fill:"#666"}}),t("animateTransform",{attrs:{attributeName:"transform",type:"rotate",values:"0 64 64;30 64 64;60 64 64;90 64 64;120 64 64;150 64 64;180 64 64;210 64 64;240 64 64;270 64 64;300 64 64;330 64 64",calcMode:"discrete",dur:"1s",repeatCount:"indefinite"}})],1)])])},staticRenderFns:[]};var r=e("VU/8")({name:"load-server"},i,!1,function(s){e("9Pyr")},"data-v-6d0f5b7c",null);t.a=r.exports},MQDK:function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("hhm8"),r=e("nJwn"),n=e("592T"),a=e("vtWP"),o=e("qwAB"),c={name:"purchase-info",props:{price:{type:String,default:""},returnTb:{type:String,default:""}}},u={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"purchase-info"},[e("div",{staticClass:"wrapper"},[e("div",{staticClass:"return-tb"},[s._m(0),s._v(" "),e("span",[s._v(s._s(s.returnTb)+"通宝")])]),s._v(" "),e("div",{staticClass:"price"},[e("span",[s._v("      商品金额")]),s._v(" "),e("span",[s._v(s._s(s.price))])]),s._v(" "),s._m(1)])])},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("span",[t("i",{staticClass:"iconfont tb-icon"},[this._v("")]),this._v("  最多可返还通宝")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"yunfei"},[t("span",[this._v("      运费(袋鼠自营商城)")]),this._v(" "),t("span",[this._v("+￥0.00")])])}]};var h=e("VU/8")(c,u,!1,function(s){e("hS7H")},"data-v-74f4fe50",null).exports,d=e("KlOE"),l={name:"delet-bar",props:{num:{type:Number,default:0},price:{type:String,default:""}},methods:{changeAll:function(){this.$emit("changeAll")},close:function(){this.$emit("close")}}},p={render:function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"purchase-bar"},[t("div",{staticClass:"num"},[this._v("实付款: "),t("span",[this._v(this._s(this.price))])]),this._v(" "),t("div",{staticClass:"delet",on:{click:this.close}},[this._v("立即购买")])])},staticRenderFns:[]};var m=e("VU/8")(l,p,!1,function(s){e("tsSi")},"data-v-38152c1c",null).exports,f={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"remark"},[e("label",[s._v("备注：")]),s._v(" "),e("input",{attrs:{maxlength:"30",placeholder:"买家留言(最多30字)"},on:{click:s.focusRemark,input:function(t){return s.$emit("input",t.target.value)}}})])},staticRenderFns:[]};var v=e("VU/8")({name:"remark",methods:{focusRemark:function(s){s.target.focus()}}},f,!1,function(s){e("x3uG")},"data-v-075500d2",null).exports,g={name:"save-bar",props:{savePrice:{type:Number,default:0}}},_={render:function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"save-bar"},[t("span",[this._v("积分袋鼠已为你节省")]),this._v(" "),t("span",[this._v("￥"+this._s(this.savePrice.toFixed(2)))])])},staticRenderFns:[]};var L=e("VU/8")(g,_,!1,function(s){e("CPmH")},"data-v-1a2dfc0a",null).exports,w=e("T452"),P=e("mtWM"),x=e.n(P),C=e("mw3O"),I=e.n(C);var $={name:"purchase-now",data:function(){return{addressInfo:null,shopList:[],showLoad:!1,price:"",remark:"",returnTb:"",savePrice:0}},components:{ShopHeader:r.a,Scroll:o.a,Store:a.a,PurchaseAddress:n.a,LoadServer:d.a,PurchaseBar:m,Remark:v,PurchaseInfo:h,SaveBar:L},created:function(){var s,t=navigator.userAgent;navigator.appVersion,t.indexOf("Android")>-1||t.indexOf("Linux");!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||(document.body.addEventListener("focusin",function(){setTimeout(function(){clearTimeout(s)},200)}),document.body.addEventListener("focusout",function(){s=setTimeout(function(){window.scrollTo(0,0)},300)}));document.title=this.$route.meta.title,this.$route.query.cartIds?this.getPurchaseNow({cartIds:this.$route.query.cartIds}):this.getPurchase({sku:this.$route.query.sku,num:this.$route.query.num}),this.getUserAddress()},methods:{getPurchase:function(s){var t=this;(function(s){return x.a.post(w.a.API.PURCHASE,I.a.stringify({sku:s.sku,num:s.num})).then(function(s){return s.data})})(s).then(function(s){if(s.code&&"00"===s.code){t.shopList.push({}),t.shopList[0].title=s.result.skuItem.title,t.shopList[0].specValueStr=s.result.skuItem.specValueStr,t.shopList[0].singleMinPayTb=s.result.skuItem.minPayTb,t.shopList[0].singlePrice=s.result.skuItem.price,t.shopList[0].oldPrice=s.result.skuItem.oldPrice,t.shopList[0].num=s.result.count,t.shopList[0].cover=s.result.skuItem.cover,t.shopList[0].singleOldPrice=s.result.skuItem.oldPrice,t.shopList[0].singleCashPrice=s.result.skuItem.cashPrice,t.shopList[0].returnTbRate=s.result.returnTbRate;for(var e=0,r=0,n=0,a=0;a<t.shopList.length;a++)n+=(t.shopList[a].singleOldPrice-t.shopList[a].singlePrice)*t.shopList[a].num,e+=t.shopList[a].singleCashPrice*t.shopList[a].num,r+=t.shopList[a].singleMinPayTb*t.shopList[a].num;t.returnTb=(100*e*Number(s.result.returnTbRate)/100).toFixed(0),t.price=i.a.priceStr(r,e),t.savePrice=n}else s.code&&"01"===s.code?i.a.toWeiXinLogin(window.location.href):t.$toastBox.showToastBox(s.message)}).catch(function(s){t.$toastBox.showToastBox(s)})},close:function(){var s,t=this;this.addressId?(this.serverState||(this.$route.query.cartIds?(this.serverState=!0,(s={remark:this.remark,cartIds:this.$route.query.cartIds,userAddressId:this.addressId},x.a.post(w.a.API.CART_ORDER,I.a.stringify({remark:s.remark,cartIds:s.cartIds,userAddressId:s.userAddressId})).then(function(s){return s.data})).then(function(s){s.code&&"00"===s.code?window.location.href=s.result.payUrl:s.code&&"01"===s.code?i.a.toWeiXinLogin(window.location.href):(t.serverState=!1,t.$toastBox.showToastBox(s.message))}).catch(function(s){t.serverState=!1,t.$toastBox.showToastBox(s)})):(this.serverState=!0,function(s){return x.a.post(w.a.API.SKU_ORDER,I.a.stringify({sku:s.sku,count:s.count,userAddressId:s.userAddressId,remark:s.remark})).then(function(s){return s.data})}({sku:this.$route.query.sku,count:this.shopList[0].num,userAddressId:this.addressId,remark:this.remark}).then(function(s){s.code&&"00"===s.code?window.location.href=s.result.payUrl:s.code&&"01"===s.code?i.a.toWeiXinLogin(window.location.href):(t.serverState=!1,t.$toastBox.showToastBox(s.message))}).catch(function(s){t.serverState=!1,t.$toastBox.showToastBox(s)}))),console.log()):this.$toastBox.showToastBox("请选择收货地址！")},getUpNum:function(s,t,e){var r=this;this.showLoad=!0,function(s){return x.a.post(w.a.API.UP_NUM,I.a.stringify({sku:s.sku,num:s.num})).then(function(s){return s.data})}(s).then(function(s){if(s.code&&"00"===s.code){r.showLoad=!1,r.shopList[e].num=t?r.shopList[e].num+1:r.shopList[e].num-1;for(var n=0,a=0,o=0,c=0;c<r.shopList.length;c++)o+=(r.shopList[c].singleOldPrice-r.shopList[c].singlePrice)*r.shopList[c].num,n+=r.shopList[c].singleCashPrice*r.shopList[c].num,a+=r.shopList[c].singleMinPayTb*r.shopList[c].num;r.returnTb=(100*n*Number(s.result.returnTbRate)/100).toFixed(0),r.price=i.a.priceStr(a,n),r.savePrice=o}else s.code&&"01"===s.code?i.a.toWeiXinLogin(window.location.href):r.$toastBox.showToastBox(s.message)}).catch(function(s){r.$toastBox.showToastBox(s)})},minus:function(s){if(this.showLoad)return!1;if(this.shopList[s].num<=1)return this.$toastBox.showToastBox("购买数量不能小于1"),!1;if(this.$route.query.cartIds)this.getUpNum({sku:this.shopList[s].sku,num:this.shopList[s].num-1},!1,s);else{this.shopList[s].num=this.shopList[s].num-1;for(var t=0,e=0,r=0,n=0;n<this.shopList.length;n++)r+=(this.shopList[n].singleOldPrice-this.shopList[n].singlePrice)*this.shopList[n].num,t+=this.shopList[n].singleCashPrice*this.shopList[n].num,e+=this.shopList[n].singleMinPayTb*this.shopList[n].num;this.returnTb=(100*t*Number(this.shopList[0].returnTbRate)/100).toFixed(0),this.price=i.a.priceStr(e,t),this.savePrice=r}},add:function(s){if(this.showLoad)return!1;if(this.$route.query.cartIds)this.getUpNum({sku:this.shopList[s].sku,num:this.shopList[s].num+1},!0,s);else{this.shopList[s].num=this.shopList[s].num+1;for(var t=0,e=0,r=0,n=0;n<this.shopList.length;n++)r+=(this.shopList[n].singleOldPrice-this.shopList[n].singlePrice)*this.shopList[n].num,t+=this.shopList[n].singleCashPrice*this.shopList[n].num,e+=this.shopList[n].singleMinPayTb*this.shopList[n].num;this.returnTb=(100*t*Number(this.shopList[0].returnTbRate)/100).toFixed(0),this.price=i.a.priceStr(e,t),this.savePrice=r}},toSetAddress:function(){var s={};this.$route.query.cartIds&&(s.cartIds=this.$route.query.cartIds),this.$route.query.sku&&(s.sku=this.$route.query.sku),this.$route.query.num&&(s.num=this.$route.query.num),this.$router.push({path:"/addressList",query:s})},getUserAddress:function(){var s=this;x.a.post(w.a.API.USER_ADDRESS).then(function(s){return s.data}).then(function(t){if(t.code&&"00"===t.code)if(s.$route.query.addressId)for(var e=0;e<t.result.length;e++)t.result[e].id==s.$route.query.addressId&&(s.addressId=t.result[e].id,s.addressInfo=t.result[e],console.log(s.addressInfo));else for(e=0;e<t.result.length;e++)"Y"===t.result[e].isDefault&&(s.addressId=t.result[e].id,s.addressInfo=t.result[e],console.log(s.addressInfo));else t.code&&"01"===t.code?i.a.toWeiXinLogin(window.location.href):s.$toastBox.showToastBox(t.message)}).catch(function(t){s.$toastBox.showToastBox(t)})},getPurchaseNow:function(s){var t=this;(function(s){return x.a.post(w.a.API.PURCHASE_NOW,I.a.stringify({cartIds:s.cartIds})).then(function(s){return s.data})})(s).then(function(s){if(s.code&&"00"===s.code){0===s.result.cartList.length&&t.$router.push({path:"/"}),t.shopList=s.result.cartList;for(var e=0,r=0,n=0,a=0;a<t.shopList.length;a++)n+=(t.shopList[a].singleOldPrice-t.shopList[a].singlePrice)*t.shopList[a].num,e+=t.shopList[a].singleCashPrice*t.shopList[a].num,r+=t.shopList[a].singleMinPayTb*t.shopList[a].num;t.returnTb=(100*e*Number(s.result.returnTbRate)/100).toFixed(0),t.price=i.a.priceStr(r,e),t.savePrice=n}else s.code&&"01"===s.code?i.a.toWeiXinLogin(window.location.href):t.$toastBox.showToastBox(s.message)}).catch(function(s){t.$toastBox.showToastBox(s)})}}},b={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"purchase-now"},[e("scroll",{staticClass:"purchase-scroll"},[e("div",[e("purchase-address",{attrs:{"address-info":s.addressInfo},on:{toSetAddress:s.toSetAddress}}),s._v(" "),e("store",{staticClass:"store",attrs:{"show-change":!1,data:s.shopList},on:{minus:s.minus,add:s.add}}),s._v(" "),e("remark",{model:{value:s.remark,callback:function(t){s.remark=t},expression:"remark"}}),s._v(" "),e("purchase-info",{attrs:{"return-tb":s.returnTb,price:s.price}})],1)]),s._v(" "),e("save-bar",{attrs:{"save-price":s.savePrice}}),s._v(" "),e("purchase-bar",{attrs:{price:s.price},on:{close:s.close}}),s._v(" "),e("load-server",{directives:[{name:"show",rawName:"v-show",value:s.showLoad,expression:"showLoad"}]})],1)},staticRenderFns:[]};var k=e("VU/8")($,b,!1,function(s){e("7Ht7")},"data-v-0f2a6408",null);t.default=k.exports},hS7H:function(s,t){},jWho:function(s,t){},"qK/+":function(s,t){},tsSi:function(s,t){},vtWP:function(s,t,e){"use strict";var i={name:"shop-car-num",props:{num:{type:Number,default:1}},methods:{minus:function(){this.$emit("minus")},add:function(){this.$emit("add")}}},r={render:function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"shop-car-num"},[t("div",{staticClass:"minus",on:{click:this.minus}},[this._v("-")]),t("div",[this._v(this._s(this.num))]),t("div",{staticClass:"add",on:{click:this.add}},[this._v("+")])])},staticRenderFns:[]};var n=e("VU/8")(i,r,!1,function(s){e("qK/+")},"data-v-4a246766",null).exports,a=e("hhm8"),o={name:"store",props:{data:{type:Array,default:[]},allChange:{type:Boolean,default:!1},showChange:{type:Boolean,default:!0}},methods:{add:function(s){this.$emit("add",s),this.$forceUpdate()},minus:function(s){this.$emit("minus",s),this.$forceUpdate()},priceTxt:function(s,t){return console.log(s,t),a.a.priceStr(s,t)},change:function(s){this.$emit("change",s),this.$forceUpdate()},changeAll:function(){this.$emit("changeAll")}},components:{ShopCarNum:n}},c={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"store"},[e("div",{staticClass:"store-name"},[e("i",{directives:[{name:"show",rawName:"v-show",value:s.showChange,expression:"showChange"}],staticClass:"iconfont",class:s.allChange?"active":" ",domProps:{innerHTML:s._s(s.allChange?"&#xe633;":"&#xe62e;")},on:{click:s.changeAll}}),s._v("袋鼠自营商城全场包邮\n  ")]),s._v(" "),s._l(s.data,function(t,i){return e("div",{staticClass:"store-item"},[e("div",{staticClass:"item-change"},[e("i",{directives:[{name:"show",rawName:"v-show",value:s.showChange,expression:"showChange"}],staticClass:"iconfont",class:t.change?"active":" ",domProps:{innerHTML:s._s(t.change?"&#xe633;":"&#xe62e;")},on:{click:function(t){return s.change(i)}}})]),s._v(" "),e("div",{staticClass:"item-img"},[e("img",{attrs:{src:t.cover,alt:""}})]),s._v(" "),e("div",{staticClass:"item-info"},[e("p",{staticClass:"title"},[s._v(s._s(t.title))]),s._v(" "),e("p",{staticClass:"type"},[s._v("规格："+s._s(t.specValueStr))]),s._v(" "),e("p",{staticClass:"price"},[s._v(s._s(s.priceTxt(t.singleMinPayTb,t.singleCashPrice)))]),s._v(" "),e("p",{staticClass:"num-wrapper"},[s._v("原价："+s._s(t.singleOldPrice))]),s._v(" "),e("shop-car-num",{staticClass:"shop-num",attrs:{num:t.num},on:{minus:function(t){return s.minus(i)},add:function(t){return s.add(i)}}})],1)])})],2)},staticRenderFns:[]};var u=e("VU/8")(o,c,!1,function(s){e("8rWN")},"data-v-278b805e",null);t.a=u.exports},x3uG:function(s,t){}});
//# sourceMappingURL=3.05ba57d4dfb689628b92.js.map